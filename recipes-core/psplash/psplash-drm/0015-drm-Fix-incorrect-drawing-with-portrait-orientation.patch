From 46e33ed8ff568c7da6951238a168d811ac884375 Mon Sep 17 00:00:00 2001
From: Hiroyuki Ishii <ishii.hiroyuki002@jp.panasonic.com>
Date: Wed, 28 Dec 2022 15:17:24 +0900
Subject: [PATCH] drm: Fix incorrect drawing with portrait orientation

Signed-off-by: Hiroyuki Ishii <ishii.hiroyuki002@jp.panasonic.com>
---
 psplash-drm.c | 10 ++++++++++
 1 file changed, 10 insertions(+)

diff --git a/psplash-drm.c b/psplash-drm.c
index fcb7507..0cb5c41 100644
--- a/psplash-drm.c
+++ b/psplash-drm.c
@@ -710,6 +710,16 @@ PSplashDRM* psplash_drm_new(int angle, int dev_id)
 	drm->canvas.angle = angle;
 	drm->canvas.rgbmode = RGB888;
 
+	switch (angle) {
+		case 270:
+		case 90:
+			drm->canvas.width  = modeset_list->height;
+			drm->canvas.height = modeset_list->width;
+			break;
+		default:
+			break;
+	}
+
 	return drm;
 error:
 	psplash_drm_destroy(drm);
-- 
2.25.1

